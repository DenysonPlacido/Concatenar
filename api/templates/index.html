<!-- api/templates/index.html -->

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <title>Ferramentas Implantação</title>
    <link rel="icon" href="/api/static/ico.png" type="image/x-icon" />
    <link rel="stylesheet" href="/api/static/style.css" />
</head>
<body>
    <div class="wrapper">
        <div class="container">
            <img class="bg-img" src="/api/static/bg.png" alt="fundo" />
            <h3 style="text-align:center;">Ferramentas para Implantação</h3>

            <div class="tab-buttons">
                <button class="tab-btn {% if active_tab == 'concat' %}active{% endif %}" onclick="mostrarAba('concat')">Concatenador</button>
                <button class="tab-btn {% if active_tab == 'json' %}active{% endif %}" onclick="mostrarAba('json')">Identador JSON</button>
            </div>

            
            <div class="tab-content {% if active_tab == 'concat' %}active{% endif %}" id="concat">
                <form method="post">
                    <input type="hidden" name="form_type" value="concat" />
                    <label>Nome da Coluna:</label>
                    <input type="text" name="coluna" value="{{ coluna }}" />
                    <label>Cole aqui os valores (1 por linha):</label>
                    <textarea name="valores">{{ valores }}</textarea>

                    <div class="btn-group">
                        <button type="submit" name="tipo" value="string" class="btn">String</button>
                        <button type="submit" name="tipo" value="numero" class="btn">Número</button>
                    </div>
                </form>

                {% if resultado %}
                <label><strong>Resultado:</strong></label>
                <div class="result-wrapper">
                    <button class="copy-btn" onclick="copiarResultado('resultado')">Copiar</button>
                    <div class="result-box" id="resultado">{{ resultado }}</div>
                </div>
                {% endif %}
            </div>

                             
                <div class="tab-content {% if active_tab == 'json' %}active{% endif %}" id="json">
                    <label>Cole ou edite seu JSON abaixo:</label>
                    <div id="jsoneditor" style="width: 100%; height: 300px; border: 1px solid #ccc; background: white;"></div>

                    <div class="btn-group" style="margin-top: 10px;">
                        <button type="button" class="btn" onclick="identarJSON()">Identar</button>
                        <button type="button" class="btn" onclick="copiarJSON()">Copiar</button>
                    </div>

                    <div id="json-error" style="color: #f55; font-weight: bold; margin-top: 10px;"></div>
                </div>

            </div>
        </div>

        <footer>
            Desenvolvido por Denyson Deserto Plácido 
        </footer>
    </div>
    <link href="https://cdn.jsdelivr.net/npm/jsoneditor@latest/dist/jsoneditor.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jsoneditor@latest/dist/jsoneditor.min.js"></script>

    <script src="/api/static/script.js"></script>
    


<script>
  let editor = null;

  window.onload = function () {
    // Inicializa editor JSON
    const container = document.getElementById("jsoneditor");
    if (container) {
      editor = new JSONEditor(container, {
        mode: 'code',
        onError: function (err) {
          document.getElementById("json-error").textContent = "Erro: " + err.message;
        }
      });
    }
  };

  function identarJSON() {
    try {
      const json = editor.get(); // se for inválido, lança erro
      const formatado = JSON.stringify(json, null, 2);
      editor.set(JSON.parse(formatado)); // limpa e aplica formatação padrão
      document.getElementById("json-error").textContent = "JSON válido!";
    } catch (e) {
      document.getElementById("json-error").textContent = "JSON inválido: " + e.message;
    }
  }

  function copiarJSON() {
    try {
      const texto = JSON.stringify(editor.get(), null, 2);
      navigator.clipboard.writeText(texto);
      alert("JSON copiado com sucesso!");
    } catch (e) {
      alert("Erro ao copiar: " + e.message);
    }
  }
</script>





</body>
</html>


